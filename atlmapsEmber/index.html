<html>
    <head>
        <!-- bower:js -->
        <script src="../bower_components/jquery/dist/jquery.js"></script>
        <script src="../bower_components/bootstrap/dist/js/bootstrap.js"></script>
        <script src="../bower_components/bootstrap-material-design/dist/js/material.js"></script>
        <script src="../bower_components/bootstrap-material-design/dist/js/ripples.js"></script>
        <script src="../bower_components/handlebars/handlebars.js"></script>
        <script src="../bower_components/ember/ember.js"></script>
        <script src="../bower_components/leaflet/dist/leaflet.js"></script>
        <script src="../bower_components/leaflet/dist/leaflet-src.js"></script>
        <script src="../bower_components/leaflet-ajax/dist/leaflet.ajax.js"></script>
        <script src="../bower_components/jquery.easing/js/jquery.easing.js"></script>
        <!-- endbower -->
        <script src="http://builds.emberjs.com/beta/ember-data.min.js"></script>
        <script src="js/bootstrap-slider.js"></script>
        <script src="js/shuffle.js"></script>
        <script src="js/app.js"></script>
        
        <!-- bower:css -->
        <link rel='stylesheet' href='../bower_components/bootstrap/dist/css/bootstrap.css' />
        <link rel='stylesheet' href='../bower_components/bootstrap-material-design/dist/css/material.css' />
        <link rel='stylesheet' href='../bower_components/bootstrap-material-design/dist/css/ripples.css' />
        <link rel='stylesheet' href='../bower_components/leaflet/dist/leaflet.css' />
        <!-- endbower -->
        <link rel='stylesheet' href='css/bootstrap-slider.css' />
        <link rel='stylesheet' href='css/local.css' />
    </head>
    <body>
        <script type="text/x-handlebars" data-template-name="application">
            <div class="navbar navbar-inverse navbar-clear">
              <ul class="nav navbar-nav">
                {{#link-to 'index' tagName='li' class='navbar-brand'}}ATL Maps{{/link-to}}
                {{#link-to 'projects' tagName='li'}}<a>Projects</a>{{/link-to}}
              </ul>
            </div>
            {{outlet "modal"}}
            <div class="content">
              {{outlet}}
              
            </div>
            <div class="footer">GSU + Emory</div>
        </script>
        
        <script type="text/x-handlebars" data-template-name="index">
          <!--<div id='banner'>
            <h1>Welcome to ATLMaps</h1>
          </div>-->
          <div class="container">
          <ul class="shuffle-items">
          <li class="item">
            <h4>Quick Facts</h4>
            <p class="alt text-muted">Cabbagetown is a neighborhood on the east side of Atlanta</p>
            <p>Cabbagetown is a neighborhood on the east side of Atlanta, Georgia, United States, abutting historic Oakland Cemetery. It includes the Cabbagetown District, a historic district listed on the U.S. National Register of Historic Places. Wikipedia</p>
          </li>
          <li class="item collapsed">
            <h4>Title 2</h4>
            <p class="alt text-muted">Item 2 summary</p>
            <p>brew; lambic, chocolate malt, shelf life. grainy aerobic alcohol sour/acidic pint glass. 
            barrel black malt units of bitterness. dry hopping ipa? sparge lauter: lauter scotch ale hard cider.</p>
          </li>
          <li class="item collapsed">
            <h4>Title 3</h4>
            <p class="alt text-muted">Item 3 dry hopping ipa? sparge lauter</p>
            <p>brew; lambic, chocolate malt, shelf life. grainy aerobic alcohol sour/acidic pint glass. 
            barrel black malt units of bitterness. dry hopping ipa? sparge lauter: lauter scotch ale hard cider.</p>
          </li>
          </ul>
          </div>
        </script>
        
        <script type='text/x-handlebars' data-template-name='createMap'>
            <div class="card layer-controls">
              <div class="form-group">
                <div class="input-group">
                <input class="form-control floating-label" id="focusedInput" type="text" placeholder="Map Name"/>
                  <span class="input-group-btn">
                  <a class="btn btn-info" {{ action 'createProject' }}>Create Map</a>
                  </span>
                </div>
              </div>
              
              <div>
                <a class="btn btn-add" {{action 'showModal' 'add-layer-modal' model}}>
                  <span class="mdi-content-add mdi-large"></span> Layers
                </a>
              </div>
            </div>

            <div id="base-map">
              {{ base-map }}
            </div>
        </script>
        
        <script type='text/x-handlebars' data-template-name='projects/index'>
          {{input valueBinding='newProject'}}<a class="btn rotate btn-add btn-fab btn-sm" {{action 'createProject'}}><span class="mdi-content-add"></span></a>
          <div class="container" id="project-list">
            {{#each project in this.model}}
            <div>
            <div class="well square">
              {{#link-to 'project' project}}
                {{project.name}}
              {{/link-to}}
              
            </div>
            <button {{action 'deleteProject' project.id}}>Delete</button>
            {{/each}}
            </div>
          </div>
        </script>
        
        <script type='text/x-handlebars' data-template-name='project'>
            {{thisProject}}
            <a class="btn btn-fab btn-sm pull-left" style="display:none;" id="show-layer-options"><span class="mdi-action-visibility"></span></a>
            <div class="layer-controls">
              <div class="card">
                <a class="btn btn-fab btn-sm pull-right" id="hide-layer-options"><span class="mdi-action-visibility-off"></span></a>
                {{savedStatus}}
                {{# if model.saved }}
                    <h1>{{model.name}}</h1>
                {{ else }}
                    {{input valueBinding='projectName'}}<a class="btn rotate btn-add btn-fab btn-sm" {{action 'updateProject'}}><span class="mdi-content-add"></span></a>
                {{/if}}
                {{getLayers}}
                <h3>Active Layers <a class="btn btn-add pull-right" {{action 'showModal' 'add-layer-modal' model}}><span class="mdi-content-add mdi-large"></span> Layers</a></h3>
                <a class="btn rotate btn-material-lightgrey btn-fab btn-sm" id="reload" {{action 'reload' this}}><span class="mdi-action-autorenew"></span></a>
                <hr/>
              </div>
              <div class="layer-list">
                <ul class="shuffle-items">
                  {{#each layer in showLayers}}
                  <li class="item">
                    <p class="alt text-muted">{{layer.name}}</p>
                    <div class="row">
                        <div class="col-xs-10">
                            <h4 class="media-heading">{{layer.name}}</h4>
                            <p>{{layer.description}}</p>
                            <p><span class="institution">{{layer.institution.name}}</span></p>
                        </div>
                        <div class="col-xs-1 pull-right">
                            <a class="btn rotate btn-added btn-fab btn-sm"{{action 'removeLayer' layer model.id}}><span class="mdi-content-clear"></span></a>
                            {{ opacity-slider layer=layer.layer layerID=layer.id }}
                        </div>
                    </div>
                    {{map-layers layerID=layer.id layerName=layer.layer}}
                  </li>
                  {{else}}
                  <li class="item">
                    <h4 class="media-heading">No Layers yet</h4>
                    <p class="alt text-muted">No Layers yet</p>
                  </li>
                  {{/each}}
                </ul>
              </div>
              </div>
            <div class="row" id="base-map">
            {{ base-map }}
            </div>
        </script>

        <script type="text/x-handlebars" data-template-name="add-layer-modal">
          {{#my-modal title='Add Layers' close='removeModal'}}
            {{#each layer in this}}
              <div class="layer-list-item row">
                <div class="col-xs-2">
                  {{add-remove-layer-button title='Add' action='addLayer' param=layer}}
                </div>
                <div class="col-xs-9">
                  {{ list-avaliable-layers layer=layer}}
                </div>
              </div>
            {{/each}}
          {{/my-modal}}
        </script>
        
        <!-- COMPONENTS -->
        
        <script type="text/x-handlebars" data-template-name="components/base-map">
          <div id='map'></div>
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/opacity-slider">
          <input class="slider" {{bind-attr class=layer name=layer}} {{action "opacityChange" on="change" param=layer}} value="10" data-slider-orientation="vertical" type="text"/>
          {{opacityslider}}
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/add-remove-layer-button">
          {{#if layerAdded}}
            <a class="btn rotate btn-added btn-fab btn-sm" {{action 'buttonToggle' this}}><span class="mdi-action-done"></span></a>
          {{else}}
            <a class="btn rotate btn-add btn-fab btn-sm" {{action 'buttonToggle'}}><span class="mdi-content-add"></span></a>
          {{/if}}
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/remove-layer-button">
            <a class="btn rotate btn-added btn-fab btn-sm"{{action 'removeLayer'}}><span class="mdi-content-clear"></span></a>
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/list-avaliable-layers">
            <h4>{{layer.name}}</h4>
            <p><strong>{{layer.layer_type}}</strong></p>
            <p>
              {{layer.description}}
            </p>
        </script>

        <script type="text/x-handlebars" data-template-name="components/my-modal">
          <div class="modal fade">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title">{{title}}</h4>
                </div>
                <div class="modal-body">
                  {{yield}}
                </div>
                <div class="modal-footer">
                  <a class="btn btn-default" data-dismiss="modal">Close</a>
                  <a class="btn btn-primary" {{action 'ok'}}>OK</a>
                </div>
              </div>
            </div>
          </div>
        </script>

        <script type="text/x-handlebars" data-template-name="components/map-layers">
          {{mappedLayers}}
        </script>
        
    </body>
</html>