<html>
    <head>
        <!-- bower:js -->
        <script src="../bower_components/jquery/dist/jquery.js"></script>
        <script src="../bower_components/bootstrap/dist/js/bootstrap.js"></script>
        <script src="../bower_components/bootstrap-material-design/dist/js/material.js"></script>
        <script src="../bower_components/bootstrap-material-design/dist/js/ripples.js"></script>
        <script src="../bower_components/handlebars/handlebars.js"></script>
        <script src="../bower_components/ember/ember.js"></script>
        <script src="../bower_components/leaflet/dist/leaflet.js"></script>
        <script src="../bower_components/leaflet/dist/leaflet-src.js"></script>
        <script src="../bower_components/leaflet-ajax/dist/leaflet.ajax.js"></script>
        <script src="../bower_components/jquery.easing/js/jquery.easing.js"></script>
        <script src="../bower_components/ember-simple-auth/simple-auth.js"></script>
        <script src="../bower_components/ember-simple-auth/simple-auth-oauth2.js"></script>
        <!-- endbower -->
        <!--<script src="http://builds.emberjs.com/beta/ember-data.min.js"></script>-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ember-data.js/1.0.0-beta.12/ember-data.prod.js"></script>
        <script src="js/bootstrap-slider.js"></script>
        <script src="js/shuffle.js"></script>
        <script src="js/app.js"></script>
        
        <!-- bower:css -->
        <link rel='stylesheet' href='../bower_components/bootstrap/dist/css/bootstrap.css' />
        <link rel='stylesheet' href='../bower_components/bootstrap-material-design/dist/css/material.css' />
        <link rel='stylesheet' href='../bower_components/bootstrap-material-design/dist/css/ripples.css' />
        <link rel='stylesheet' href='../bower_components/leaflet/dist/leaflet.css' />
        <!-- endbower -->
        <link rel='stylesheet' href='css/bootstrap-slider.css' />
        <link rel='stylesheet' href='css/local.css' />
    </head>
    <body>
        <script type="text/x-handlebars" data-template-name="application">
            <div class="navbar navbar-inverse navbar-clear">
                <ul class="nav navbar-nav">
                    {{#link-to 'index' tagName='li' class='navbar-brand'}}ATLMaps{{/link-to}}
                    {{#link-to 'projects' tagName='li'}}<a>Projects</a>{{/link-to}}
                    {{#link-to 'about' tagName='li'}}<a>About</a>{{/link-to}}
                </ul>
                {{#if session.isAuthenticated}}
                    <a {{ action 'invalidateSession' }} class="btn btn-xs navbar-right nav-btn">Logout</a>
                {{else}}
                    {{#link-to 'login' class="btn btn-xs navbar-right nav-btn"}}Login{{/link-to}}
                {{/if}}
            </div>
            {{outlet "modal"}}
            <div class="content">
              {{outlet}}
              
            </div>
        </script>
        
        <script type="text/x-handlebars" data-template-name="index">
          <div id='banner'>
            <h1>Welcome to ATLMaps</h1>
          </div>
          {{session}}
        </script>
        
        <script type='text/x-handlebars' data-template-name='projects/index'>
            <div class="continer" id="create_project">
                <a class="btn btn-add" {{action 'createProject'}}><span class="mdi-content-add mdi-large"></span>Create New Project</a></h3>
            </div>
          <div class="container" id="project-list">
            {{#each project in this.model}}
            <div>
            <div class="well square">
                <h3 class="heading">{{#link-to 'project' project action='reload'}}{{project.name}}{{/link-to}}</h3>
                
                <a class="btn btn-warning btn-fab action project-delete" {{action 'deleteProject' project.id}}><span class="mdi-action-delete"></span></a>

            </div>
            {{/each}}
            </div>
          </div>
        </script>
        
        <script type='text/x-handlebars' data-template-name='project'>
            {{thisProject}}
            <a class="btn btn-fab btn-sm pull-left" style="display:none;" id="show-layer-options"><span class="mdi-action-visibility"></span></a>
            <div class="layer-controls">
              <div class="card">
                <a class="btn btn-fab btn-sm pull-right" id="hide-layer-options"><span class="mdi-action-visibility-off"></span></a>
                {{# if model.saved }}
                    <h1>{{model.name}}</h1>
                {{ else }}
                    {{#if session.isAuthenticated}}
                        {{input valueBinding='projectName' placeholder='Enter Title for Project'}}<a class="btn btn-add btn-fab btn-sm" {{action 'updateProject'}}><span class="mdi-content-add"></span></a>
                    {{/if}}
                {{/if}}
                {{getLayers}}
                <h3>Active Layers <a class="btn btn-add pull-right" {{action 'showModal' 'add-layer-modal'}}><span class="mdi-content-add mdi-large"></span> Layers</a></h3>
                <a class="btn btn-material-lightgrey btn-fab btn-sm" id="reload" {{action 'reload' this}}><span class="mdi-action-autorenew"></span></a>
                <hr/>
              </div>
              <div class="layer-list">
                <ul class="shuffle-items">
                  {{#each layer in showLayers}}
                  <li class="item">
                    <p class="alt text-muted">{{layer.name}}</p>
                    <div class="row">
                        <div class="col-xs-10">
                            <h4 class="media-heading">{{layer.name}}</h4>
                            <p>{{layer.description}}</p>
                            {{partial 'citation'}}
                        </div>
                        <div class="col-xs-1 pull-right">
                            <a class="btn rotate btn-added btn-fab btn-sm"{{action 'removeLayer' layer model.id}}><span class="mdi-content-clear"></span></a>
                            {{ opacity-slider layer=layer.layer layerID=layer.id }}
                        </div>
                    </div>
                    {{map-layers layerID=layer.id layerName=layer.layer}}
                  </li>
                  {{else}}
                  <li class="item">
                    <h4 class="media-heading">No Layers yet</h4>
                    <p class="alt text-muted">No Layers yet</p>
                  </li>
                  {{/each}}
                </ul>
              </div>
              
              </div>
            <div class="row" id="base-map">
            {{ base-map }}
            </div>
        </script>

        <script type="text/x-handlebars" data-template-name="add-layer-modal">
          {{#my-modal title='Add Layers' close='removeModal'}}
            {{#each layer in this}}
              <div class="layer-list-item row">
                <div class="col-xs-2">
                  {{add-remove-layer-button title='Add' action='addLayer' param=layer model=model}}
                </div>
                <div class="col-xs-9">
                  {{ list-avaliable-layers layer=layer}}
                </div>
              </div>
            {{/each}}
          {{/my-modal}}
        </script>
        
        <script type='text/x-handlebars' data-template-name='about'>
            <p>Here we will do some about text and some branding. YAY!</p>
        </script>
        
        <script type='text/x-handlebars' data-template-name='login'>
            <form {{action 'authenticate' on='submit'}}>
  <label for="identification">Login</label>
  {{input value=identification placeholder='Enter Login'}}
  <label for="password">Password</label>
  {{input value=password placeholder='Enter Password' type='password'}}
  <button type="submit">Login</button>
</form>
        </script>
        
        <!-- COMPONENTS -->
        
        <script type="text/x-handlebars" data-template-name="components/base-map">
          <div id='map'></div>
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/opacity-slider">
          <input {{bind-attr class=":slider layer" name=layer}} {{action "opacityChange" on="change" param=layer}} value="10" data-slider-orientation="vertical" type="text"/>
          {{opacityslider}}
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/add-remove-layer-button">
          {{is_active}}
          {{#if layerAdded }}
            <a class="btn rotate btn-added btn-fab btn-sm" {{action 'buttonRemoveLayer' this.layer this.model.id }}><span class="mdi-action-done"></span></a>
          {{else}}
            <a class="btn rotate btn-add btn-fab btn-sm" {{action 'buttonAddLayer' this.layer}}><span class="mdi-content-add"></span></a>
          {{/if}}
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/remove-layer-button">
            <a class="btn rotate btn-added btn-fab btn-sm"{{action 'removeLayer'}}><span class="mdi-content-clear"></span></a>
        </script>
        
        <script type="text/x-handlebars" data-template-name="components/list-avaliable-layers">
            <h4>{{layer.name}}</h4>
            <p>
              {{layer.description}}
            </p>
            {{partial 'citation'}}
        </script>

        <script type="text/x-handlebars" data-template-name="components/my-modal">
          <div class="modal fade">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title">{{title}}</h4>
                </div>
                <div class="modal-body">
                  {{yield}}
                </div>
                <div class="modal-footer">
                  <a class="btn btn-default" data-dismiss="modal">Close</a>
                  <a class="btn btn-primary" {{action 'ok'}}>OK</a>
                </div>
              </div>
            </div>
          </div>
        </script>

        <script type="text/x-handlebars" data-template-name="components/map-layers">
          {{mappedLayers}}
        </script>
        
        <script type='text/x-handlebars' data-template-name='_citation'>
            <p>Provided by: <img {{bind-attr src='layer.institution.icon'}} alt='Logo' class="institution_logo" /> <span class="institution">{{layer.institution.name}}</span></p>
        </script>
        
    </body>
</html>
